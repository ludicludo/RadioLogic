cmake_minimum_required(VERSION 2.8)
project(MultipleStepsJobPlugin)
set(ORTHANC_FRAMEWORK_VERSION "mainline")
set(ORTHANC_FRAMEWORK_SOURCE "hg" CACHE STRING "Source of the Orthanc source code (can be \"hg\", \"archive\", \"web\" or \"path\")")
set(USE_SYSTEM_ORTHANC_SDK ON CACHE BOOL "Use the system version of the Orthanc plugin SDK")
execute_process(
  COMMAND
  /usr/bin/python ${CMAKE_SOURCE_DIR}/Resources/SyncOrthancFolder.py
)
include(${CMAKE_SOURCE_DIR}/Resources/Orthanc/DownloadOrthancFramework.cmake)
set(ORTHANC_FRAMEWORK_PLUGIN ON)
include(${ORTHANC_ROOT}/Resources/CMake/OrthancFrameworkParameters.cmake)
set(ENABLE_LOCALE ON)
set(ENABLE_MODULE_IMAGES OFF CACHE INTERNAL "Enable module for image processing")
set(ENABLE_MODULE_DICOM OFF CACHE INTERNAL "Enable module for DICOM handling")
include(${ORTHANC_ROOT}/Resources/CMake/OrthancFrameworkConfiguration.cmake)
include_directories(
${ORTHANC_ROOT}
${ORTHANC_ROOT}/Core
${ORTHANC_ROOT}/Plugins/Include
)
add_definitions(
  -DHAS_ORTHANC_EXCEPTION=1
  -DORTHANC_ENABLE_LOGGING_PLUGIN=1
)
set(CORE_SOURCES
  ${ORTHANC_ROOT}/Plugins/Samples/Common/OrthancPluginCppWrapper.cpp
  ${ORTHANC_CORE_SOURCES}
)
add_library(MultipleStepsJobPlugin SHARED 
  ${CORE_SOURCES}
  ${CMAKE_SOURCE_DIR}/MultipleStepsJobPlugin.cpp
  ${CMAKE_SOURCE_DIR}/MyJob.cpp
  ${AUTOGENERATED_SOURCES}
)
